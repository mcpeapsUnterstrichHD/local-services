services:
  npmplus:
    container_name: npmplus-comboom.sucht
    image: docker.io/zoeyvid/npmplus:latest # or ghcr.io/zoeyvid/npmplus:latest
    #pull_policy: always
    restart: always
    network_mode: host
    ipc: host # required when you want to use the openappsec attachment module
    cap_add: # required if you set NGINX_QUIC_BPF to true
      - BPF # required if you set NGINX_QUIC_BPF to true
      - PERFMON # required if you set NGINX_QUIC_BPF to true
      - NET_ADMIN # required if you set NGINX_QUIC_BPF to true
    volumes:
      - "./npmplus/data:/data"
      - "./npmplus/www:/var/www" # optional, if you want to use NPMplus directly as webserver for html/php
      #      - "/path/to/old/npm/letsencrypt/folder:/etc/letsencrypt" # Only needed for first time migration from original nginx-proxy-manager to this fork, remove after migration
      #      - "shm-volume:/dev/shm/check-point" # required if you want to use the openappsec attachment module, also enable this volume at the end of this compose.yaml
      - "/etc/localtime:/etc/localtime"
    environment:
      TZ: "Europe/Berlin" # set timezone, required, set it to one of the values from the "TZ identifier" https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List
      ACME_EMAIL: "mcpeaps_HD@outlook.com" # email address which should be used for acme, currently optional, may be required in the future, so I recommend you to enter your email here, optional for letsencrypt, but required for zerossl and google public ca
      #      ACME_SERVER: "https://dv.acme-v02.api.pki.goog/directory (google public ca) / https://acme.zerossl.com/v2/DV90 (zerossl)" # acme server used when requesting/renewing certs using certbot, default is set to: https://acme-v02.api.letsencrypt.org/directory (letsencrypt)
      #      ACME_EAB_KID: "123456789abcdef" # Key Identifier for External Account Binding for the acme server, not supported by letsencrypt, optional for zerossl (Login on theier site => Developer), but required for google public ca: https://cloud.google.com/certificate-manager/docs/public-ca-tutorial?hl=de#request-key-hmac
      #      ACME_EAB_HMAC_KEY: "123456789abcdef" # HMAC key for External Account Binding for the acme server, not supported by letsencrypt, optional for zerossl (Login on theier site => Developer), but required for google public ca: https://cloud.google.com/certificate-manager/docs/public-ca-tutorial?hl=de#request-key-hmac
      #      ACME_MUST_STAPLE: "true" # enables must-staple, default false, I recommend you to enable this if your CA supports it, supported by zerossl, google public ca ignores this, unsupported by letsencrypt (will fail), overrides ACME_OCSP_STAPLING to true
      #      ACME_OCSP_STAPLING: "true" # enables ocsp stapling, default false, I recommend you to enable this if your CA supports it, supported by zerossl and google public ca
      #      ACME_PROFILE: "shortlived" # sets the profile to be used from the acme server, default is "none" (so the default profile), supported by letsencrypt (https://letsencrypt.org/docs/profiles), if you use letsencrypt I would recommend the "shortlived" profile, until it is public you should use the "tlsserver" profile, note: both are limited to 25 domains per cert instead of 100 like the "classic" (default) profile
      ACME_KEY_TYPE: "rsa" # which key type to use ecdsa or rsa, default and recommended: ecdsa
      ACME_SERVER_TLS_VERIFY: "false" # enables checking if ACME_SERVER has a valid TLS cert, default and recommended true
      #CUSTOM_OCSP_STAPLING: "true" # enables ocsp stapling for custom certs, default false, I recommend you to enable this if your custom certs support it
      #      PUID: "1000" # set group id, needs to be a number greater or equal to 99, or equal to 0, default 0 (root)
      #      PGID: "1000" # set user id, needs to be a number greater or equal to 99, or equal to 0, default 0 (root), requires PUID to be not 0
      #      NPM_PORT: "82" # Port the NPM UI should be bound to, default 81, you need to change it, if you want to run multiple npm instances in network mode host
      #      GOA_PORT: "92" # Port the goaccess should be bound to, default 91, you need to change it, if you want to run multiple npm with goaccess instances in network mode host
      #      IPV4_BINDING: "127.0.0.1" # IPv4 address to bind, defaults to all
      #      NPM_IPV4_BINDING: "127.0.0.1" # IPv4 address to bind for the NPM UI, defaults to all
      #      GOA_IPV4_BINDING: "127.0.0.1" # IPv4 address to bind for the goaccess, defaults to all
      #      IPV6_BINDING: "[::1]" # IPv6 address to bind, defaults to all
      #      NPM_IPV6_BINDING: "[::1]" # IPv6 address to bind for the NPM UI, defaults to all
      #      GOA_IPV6_BINDING: "[::1]" # IPv6 address to bind for goaccess, defaults to all
      #      DISABLE_IPV6: "true" # fully disables listing on IPv6 and the IPv6 resolver of nginx, overrides IPV6_BINDING/NPM_IPV6_BINDING/GOA_IPV6_BINDING, default false
      #      NPM_LISTEN_LOCALHOST: "true" # Binds the NPM UI only to localhost (IPv4+IPv6), overrides NPM_IPV4_BINDING/NPM_IPV6_BINDING, default false
      #      GOA_LISTEN_LOCALHOST: "true" # Binds goaccess only to localhost (IPv4+IPv6), overrides NPM_IPV4_BINDING/NPM_IPV6_BINDING, default false
      #      DEFAULT_CERT_ID: "1" # ID of cert, which should be used instead of dummycerts, default 0/unset/dummycerts
      #      HTTP_PORT: "8080" # tcp port to use for http traffic, changing this may breaks certbot http challenge, default 80
      #      HTTPS_PORT: "8443" # udp and tcp port to use for https traffic, changing this may breaks certbot http challenge, default 443
      #      HTTP3_ALT_SVC_PORT: "8443" # please change this if the udp port the clients connect to is not 443, default 443
      #      DISABLE_HTTP: "true" # disables nginx to listen on port 80, default false
      #      LISTEN_PROXY_PROTOCOL: "true" # should listeners of http(s) hosts (proxy/redirect/dead and default) use proxy protocol instead of http(s)? default false, overrides DISABLE_H3_QUIC to true
      #      DISABLE_H3_QUIC: "true" # disables nginx to listen on port 443 udp for default host and all your hosts, this will fully disable HTTP/3 and QUIC, even if you enable it inside the UI, not recommended, default false
      NGINX_QUIC_BPF: "true" # enables nginxs quic_bpf (https://nginx.org/en/docs/http/ngx_http_v3_module.html#quic_bpf), you also need to add caps to the NPMplus container (see cap_add of this compose file) to use this, recommended, default false
      NGINX_LOG_NOT_FOUND: "true" # Log 404 errors to the docker logs, unrelated to access logs, default false
      NGINX_404_REDIRECT: "true" # Redirect to / instead of showing a 404 error page, default false
      NGINX_HSTS_SUBDOMAINS: "true" # when enabling security headers, also enable hsts for subdomains, recommended, default true
      #      X_FRAME_OPTIONS: "deny" # value to use for the X-Frame-Options header when enabling security headers, valid is "deny", "sameorigin" and "none" (means unset), default sameorigin, since this applies to all hosts I recommend you to instead keep the default and only change it for hosts which need it using the advanced config and more_set_headers
      #      NGINX_DISABLE_PROXY_BUFFERING: "true" # Disables the proxy_buffering/proxy_request_buffering options of nginx by default for all hosts, default false, may not work if you use crowdsec/appsec
      #      NGINX_WORKER_PROCESSES: "8" # value of worker_processes, default and recommended: auto
      #      NGINX_WORKER_CONNECTIONS: "1024" # value of worker_connections, default: 512
      #      DISABLE_NGINX_BEAUTIFIER: "true" # disables nginxbeautifier, useful when it fails parsing non-standard custom/advanced configs, default false
      #      FULLCLEAN: "true" # Clean unused config folders, default false
      #      LOGROTATE: "true" # Enables writing http access logs to /opt/npmplus/nginx/access.log, stream access logs to /opt/npmplus/nginx/stream.log and enables daily logrotation, default false
      #      LOGROTATIONS: "7" # Set how often the access.log should be rotated until it is deleted, default 3
      SKIP_IP_RANGES: "false" # Skip feteching/whitelisting ip ranges from cloudflare, default true
    #      IPRT: "3" # Set how many hours should be between updating ip ranges from aws and cloudflare, default 1, ignored when SKIP_IP_RANGES is true
    #      CRT: "72" # Set how many hours should be between certbot trying to renew your certs, default 23
    #      GOA: "true" # Enables goaccess (and overrides LOGROTATE to true), default false --- if you download the GeoLite2-Country.mmdb, GeoLite2-City.mmdb AND GeoLite2-ASN.mmdb file from MaxMind and place them in /opt/npmplus/goaccess/geoip it will automatically enable GeoIP in goaccess after restarting NPMplus (no need to change GOACLA below), you may also enable the geoipupdate container below (please change the timezone)
    #      GOACLA: "--agent-list --real-os --double-decode --anonymize-ip --anonymize-level=2 --keep-last=7 --with-output-resolver --no-query-string" # Arguments that should be passed to goaccess, default: --agent-list --real-os --double-decode --anonymize-ip --anonymize-level=1 --keep-last=30 --with-output-resolver --no-query-string
    #      PHP82: "true" # Activate PHP82, default false, supported, but not recommended, you should prefer to use a dedicated php-fpm container
    #      PHP82_APKS: "php82-curl php82-openssl" # Add php extensions, also enables PHP82, see available packages here: https://pkgs.alpinelinux.org/packages?branch=v3.21&repo=community&arch=x86_64&name=php82-*, default none, requires PHP82
    #      PHP83: "true" # Activate PHP83, default false, supported, but not recommended, you should prefer to use a dedicated php-fpm container
    #      PHP83_APKS: "php83-curl php83-openssl" # Add php extensions, also enables PHP83, see available packages here: https://pkgs.alpinelinux.org/packages?branch=v3.21&repo=community&arch=x86_64&name=php83-*, default none, requires PHP83
    #      PHP84: "true" # Activate PHP84, default false, supported, but not recommended, you should prefer to use a dedicated php-fpm container
    #      PHP84_APKS: "php84-curl php84-openssl" # Add php extensions, also enables PHP84, see available packages here: https://pkgs.alpinelinux.org/packages?branch=v3.21&repo=community&arch=x86_64&name=php84-*, default none, requires PHP84
    #      PHP_APKS: "php-pecl-apcu php-pecl-redis" # Add php extensions, see available packages here: https://pkgs.alpinelinux.org/packages?branch=v3.21&repo=community&arch=x86_64&name=php-*, default none, requires PHP82, PHP83 and/or PHP84, not recommended, please use PHP82_APKS, PHP83_APKS or PHP84_APKS
    #      INITIAL_ADMIN_EMAIL: "mcpeaps_HD@outlook.com" # email to use instead of admin@example.org on first start of NPMplus for the initial user
    #      INITIAL_ADMIN_PASSWORD: "fabian66" # password to use instead of a random password which is logged on first start of NPMplus for the initial user
    #      INITIAL_DEFAULT_PAGE: "444" # default page to set on first start of NPMplus for the initial user, default congratulations, can be one of: 404, 444, redirect, congratulations or html
    #      ENABLE_PRERUN: "true" # see readme, default off
    #      NGINX_LOAD_OPENAPPSEC_ATTACHMENT_MODULE: "true" # loads the openappsec attachment module, you also need to set ipc and enable the shm-volume for NPMplus in this composse file, this will fully disable brotli, default false
    #      NGINX_LOAD_OPENTELEMETRY_MODULE: "true" # loads the opentelemetry module, you need to configure this yourself, default false
    #      NGINX_LOAD_GEOIP2_MODULE: "true" # loads the geoip2 module, you need to configure this yourself, default false
    #      NGINX_LOAD_NJS_MODULE: "true" # loads the njs module (nginx JavaScript module), you need to configure this yourself, default false
    #      NGINX_LOAD_NTLM_MODULE: "true" # loads the ntml module, you need to configure this yourself, default false
    #      NGINX_LOAD_VHOST_TRAFFIC_STATUS_MODULE: "true" # loads the virtual host traffic status module, you need to configure this yourself, default false
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        limits:
          cpus: "1.0"
          memory: 1G
    labels:
      glance.name: Nginx Proxy Manager Plus
      glance.icon: si:nginxproxymanager
      glance.url: https://npmplus.localhost
      glance.description: Nginx Proxy Manager Plus - Reverse proxy manager.
      glance.id: npmplus
      glance.tags: "type:proxy, type:management, type:reverse, type:service, type:web, type:gui"
      glance.hide: false

  searxng:
    container_name: searxng-comboom.sucht
    image: searxng/searxng:2025.9.10-a9b088d
    #pull_policy: always
    networks:
      local-services:
        ipv4_address: 192.168.1.3
        ipv6_address: fd07:b51a:cc66:d001::0003
    environment:
      TZ: "Europe/Berlin"
    ports:
      - "8082:8080"
    volumes:
      - ./searxng/conf:/etc/searxng:rw
      - ./searxng/themes:/usr/local/searxng/searx/static/themes
      - /etc/localtime:/etc/localtime
    restart: always
    labels:
      glance.name: SearXNG
      glance.icon: si:searxng
      glance.url: https://search.localhost
      glance.description: Search engine
      glance.id: searxng
      glance.tags: "type:search, type:service, type:web, type:gui"
      glance.hide: false
  it-tools:
    container_name: it-tools-comboom.sucht
    image: ghcr.io/sharevb/it-tools:nightly
    #pull_policy: always
    ports:
      - "8083:8080"
    environment:
      NODE_ENV: production
    networks:
      local-services:
        ipv4_address: 192.168.1.4
        ipv6_address: fd07:b51a:cc66:d001::0004
    restart: always
    labels:
      glance.name: IT Tools
      glance.icon: di:it-tools
      glance.url: https://it-tools.localhost
      glance.description: Collection of handy online tools for developers, with great UX.
      glance.id: it-tools
      glance.tags: "type:it,type:tools, type:service, type:web, type:gui"
      glance.hide: false
  stirling-pdf:
    container_name: stirling-pdf-comboom.sucht
    image: stirlingtools/stirling-pdf:latest-fat
    #pull_policy: always
    ports:
      - "8081:8081"
      - "8080:8080"
    volumes:
      - ./pdf/trainingData:/usr/share/tessdata #Required for extra OCR languages
      - ./pdf/extraConfigs:/configs
      - ./pdf/customFiles:/customFiles/
      - ./pdf/logs:/logs/
      - /opt/homebrew/bin/rar:/usr/local/bin/rar:ro
      - /opt/homebrew/bin/fontforge:/usr/local/bin/fontforge:ro
    env_file:
      - ./pdf/.env


    deploy:
      resources:
        limits:
          cpus: "4.0"
    networks:
      local-services:
        ipv4_address: 192.168.1.5
        ipv6_address: fd07:b51a:cc66:d001::0005
    restart: always
    labels:
      glance.name: Sirling PDF
      glance.icon: di:stirling-pdf
      glance.url: https://stirling-pdf.localhost
      glance.description: Local hosted web based PDF editor
      glance.id: stirling-pdf
      glance.tags: "type:pdf, type:conversion, type:service, type:web, type:gui"
      glance.hide: false

  mariadb:
    image: mariadb:latest
    #pull_policy: always
    container_name: mariadb-comboom.sucht
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: "fabian66"
      MYSQL_INITDB_SKIP_TZINFO: "1"
    networks:
      local-services:
        ipv4_address: 192.168.1.6
        ipv6_address: fd07:b51a:cc66:d001::0006
    volumes:
      - ./all-databases.sql:/all-databases.sql
      - ./mariadb_data:/var/lib/mysql
    ports:
      - "3306:3306"
    labels:
      glance.name: MariaDB
      glance.icon: si:mariadb
      glance.description: Database
      glance.id: mariadb
      glance.parent: phpmyadmin
      glance.tags: "type:database"
      glance.hide: false

  phpmyadmin:
    #pull_policy: always
    container_name: phpmyadmin-comboom.sucht
    links:
      - mariadb:db
    depends_on:
      - mariadb
    image: phpmyadmin
    restart: always
    ports:
      - 8085:80
    volumes:
      - ./phpmyadmin/config.user.inc.php:/etc/phpmyadmin/config.user.inc.php
      - ./phpmyadmin/themes:/var/www/html/themes
    environment:
      PMA_ARBITRARY: "1"
    networks:
      local-services:
        ipv4_address: 192.168.1.7
        ipv6_address: fd07:b51a:cc66:d001::0007
    labels:
      glance.name: phpMyAdmin
      glance.icon: si:phpmyadmin
      glance.url: https://phpmyadmin.localhost
      glance.description: Database management
      glance.id: phpmyadmin
      glance.tags: "type:web,type:database,type:gui"
      glance.hide: false
  glance:
    container_name: glance-comboom.sucht
    image: glanceapp/glance
    #pull_policy: always
    network_mode: host
    restart: always
    volumes:
      - ./glance/config:/app/config
      - ./glance/assets:/app/assets
      - ./glance/myPages:/myPages
      - ./glance/myColumns:/myColumns
      - ./glance/myWidgets:/myWidgets
      # Optionally, also mount docker socket if you want to use the docker containers widget
      - /var/run/docker.sock:/var/run/docker.sock:ro
    env_file: ./glance/.env
    labels:
      glance.name: Glance
      glance.description: Dashboard
      glance.id: glance
      glance.icon: di:glance
      glance.url: https://dashboard.localhost/home
      glance.tags: "type:web,type:dashboard"
      glance.hide: false

  glance-github-graph:
    image: haumea/glance-github-graph:latest
    container_name: glance-github-graph-comboom.sucht
    #pull_policy: always
    restart: always
    ports:
      - 8084:8080
    environment:
      - CACHE_ENABLED=true
      - CACHE_TYPE=memory
      - CACHE_DURATION_SECS=3600
    networks:
      local-services:
        ipv4_address: 192.168.1.10
        ipv6_address: fd07:b51a:cc66:d001::000A
  glance-agent:
    container_name: glance-agent-comboom.sucht
    image: glanceapp/agent
    #pull_policy: always
    restart: always
    # command: /app/agent --config /opt/glance-agent/agent.yml
    # environment:
    # Optional, leave empty or comment out for no authentication
    # TOKEN: your_auth_token_here
    volumes:
      # Add your mount points below in the format host_path:container_path with :ro suffix for read-only
      - "/:/Volumes/Macintosh HD/:ro"
      # - "/Volumes/Macintosh HD/:/storage/Macintosh HD/:ro"
      - ./glance/agent:/app/config/
    ports:
      - 27973:27973
    networks:
      local-services:
        ipv4_address: 192.168.1.11
        ipv6_address: fd07:b51a:cc66:d001::000B

  redis:
    image: redis:latest
    #pull_policy: always
    container_name: redis-comboom.sucht
    restart: always
    volumes:
      - redis-data:/data
    networks:
      local-services:
        ipv4_address: 192.168.1.8
        ipv6_address: fd07:b51a:cc66:d001::0008
    ports:
      - "6379:6379"
    healthcheck:
      test: ["CMD-SHELL", "redis-cli ping | grep PONG"]
      start_period: 20s
      interval: 30s
      retries: 5
      timeout: 3s
    labels:
      glance.name: Redis
      glance.description: Redis
      glance.id: redis
      glance.icon: si:redis
      glance.tags: "type:cache,type:queue"
      glance.hide: false

  #     glance.hide: false
  # wordpress:
  #   image: bitnami/wordpress
  #   volumes:
  #     - ./wordpress-data:/bitnami/wordpress
  #   environment:
  #     WORDPRESS_DATABASE_HOST: mariadb-comboom.sucht
  #     WORDPRESS_DATABASE_PORT_NUMBER: 3306
  #     WORDPRESS_DATABASE_NAME: wordpress_db
  #     WORDPRESS_DATABASE_USER: wordpress
  #     WORDPRESS_DATABASE_PASSWORD: wordpress
  #     WORDPRESS_TABLE_PREFIX: wordpress_db
  #     WORDPRESS_BLOG_NAME: comboom.sucht
  #     WORDPRESS_FIRST_NAME: mcpeaps_HD
  #     WORDPRESS_LAST_NAME: MAHD
  #     WORDPRESS_USERNAME: mahd
  #     WORDPRESS_PASSWORD: fabian66
  #     WORDPRESS_EMAIL: mcpeaps_HD@outlook.com
  #     #WORDPRESS_SMTP_HOST: ${WORDPRESS_SMTP_ADDRESS}
  #     #WORDPRESS_SMTP_PORT: ${WORDPRESS_SMTP_PORT}
  #     #WORDPRESS_SMTP_USER: ${WORDPRESS_SMTP_USER_NAME}
  #     #WORDPRESS_SMTP_PASSWORD: ${WORDPRESS_SMTP_PASSWORD}
  #   networks:
  #     local-services:
  #       ipv4_address: 192.168.1.14
  #       ipv6_address: fd07:b51a:cc66:d001::000E
  #   ports:
  #     - "8089:8080"
  #     - "8090:8443"
  #   restart: always
  #   pull_policy: always
  #   depends_on:
  #     - mariadb

  adguardhome:
    image: adguard/adguardhome:edge
    container_name: adguardhome-comboom.sucht
    #pull_policy: always
    restart: always
    volumes:
      - ./adguardhome/work:/opt/adguardhome/work
      - ./adguardhome/conf:/opt/adguardhome/conf
      - /etc/localtime:/etc/localtime
    #ports:
    #  - 5353:53/tcp
    #  - 5353:53/udp
    #  - 6767:67/udp
    #  - 6868:68/udp
    #  - 8096:80/tcp
    #  - 8098:443/tcp
    #  - 8098:443/udp
    #  - 8099:3000/tcp
    #  - 9853:853/tcp
    #  - 9784:784/udp
    #  - 9853:853/udp
    #  - 8953:8853/udp
    #  - 7443:5443/tcp
    #  - 7443:5443/udp
    #extra_hosts:
    #  - host.docker.internal:host-gateway
    network_mode: host
    labels:
      glance.name: Adguard Home
      glance.description: Adguard Home
      glance.id: adguardhome
      glance.url: https://adguardhome.localhost
      glance.icon: di:adguardhome
      glance.tags: "type:service,type:web,type:gui"
      glance.hide: false

  uptime-kuma:
    image: "louislam/uptime-kuma"
    #pull_policy: always
    container_name: uptime-kuma-comboom.sucht
    volumes:
      - "./uptime-kuma:/app/data"
      - /var/run/docker.sock:/var/run/docker.sock:ro
    ports:
      - "8106:3001"
    restart: always
    networks:
      local-services:
        ipv4_address: 192.168.1.9
        ipv6_address: fd07:b51a:cc66:d001::009

networks:
  local-services:
    name: local-services
    ipam:
      driver: default
      config:
        - subnet: 192.168.1.0/24
          gateway: 192.168.1.2
          ip_range: 192.168.1.0/24
        - subnet: fd07:b51a:cc66:d001::/64
          gateway: fd07:b51a:cc66:d001::02
          ip_range: fd07:b51a:cc66:d001::/64

volumes:
  redis-data:
